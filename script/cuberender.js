/*! cuberender / 2015-08-23 / License: MIT */
!function(a,b){var c,d,e,f,g;c=["f","u","r","l","d","b"],middleMoves=["M","E","S"],e="rotate3D(-1, -1, 0, 45deg) ",d={top:{f:[0,8],u:[0,2],r:[0,2],d:[0,2],l:[0,2],b:!1},middle:{f:!1,u:[3,5],r:[3,5],d:[3,5],l:[3,5],b:!1},bottom:{f:!1,u:[6,8],r:[6,8],d:[6,8],l:[6,8],b:[0,8]}};var h=function(){var a=b.querySelectorAll(".cuberender");i(),[].forEach.call(a,function(a){var b=Object.create(j,l);b.create(a)})},i=function(){f=function(){var a,c,d;return a={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},c=b.createElement("a"),d=null,Object.keys(a).forEach(function(b){return void 0!==c.style[b]?(d=a[b],!1):void 0}),d}(),g=function(){var a,c,d;return a=["WebkitTransform","MozTransform","OTransform","transform"],c=b.createElement("a"),d=null,a.forEach(function(a){return void 0!==c.style[a]?(d=a,!1):void 0}),d}()},j=Object.create(null),k={writable:!0},l={wrapper:k,layout:k,moves:k,cubeObj:k,nodes:k,current:k,afterTransitionLayout:k,playing:k},m=function(a){return-1!==middleMoves.indexOf(a.charAt(0))},n=function(a){if(null===a||"object"!=typeof a||"isActiveClone"in a)return a;var b=a.constructor();for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(a.isActiveClone=null,b[c]=n(a[c]),delete a.isActiveClone);return b};j.create=function(a){this.wrapper=a,this.nodes={},this.current=-1,this.playing=!1,this.readLayout(),this.readMoves(),this.generateCube(),this.generateTimeline(),this.generateNavigation(),this.generateTimelineNavigation(),this.playNext()},j.generateTimelineNavigation=function(){this.nodes.moves.addEventListener("click",this.playMove.bind(this)),[].forEach.call(this.nodes.moves.querySelectorAll("li"),function(a,c){var d=b.createElement("a");d.href="#",d.innerHTML=a.innerHTML,a.innerHTML="",a.appendChild(d),d.setAttribute("data-index",c)})},j.readLayout=function(){var a,b;return b=this.wrapper.querySelector(".cube-layout"),null===b?!1:(a={},c.forEach(function(c){var d,e;return d=b.querySelector("."+c),null===d?void(a[c]=[]):(e=(d.innerText||d.textContent).split(" "),void(9===e.length?a[c]=e:a[c]=[]))}),void(this.layout=a))},j.readMoves=function(){var a;return this.nodes.moves=this.wrapper.querySelector(".moves"),null===this.nodes.moves?!1:(a=[].map.call(this.nodes.moves.querySelectorAll("li"),function(a){return{code:a.innerText||a.textContent,highlight:a.getAttribute("data-highlight")||null}}),void(this.moves=a))},j.generateCube=function(){var a,c,e;a="div",c=b.createElement(a),c.classList.add("cube"),cubeObj={cube:c},Object.keys(d).forEach(function(e){var f=b.createElement(a);f.classList.add(e,"layer"),cubeObj[e]=f,c.appendChild(f),Object.keys(d[e]).forEach(function(c){var g,h,i;if(g=b.createElement(a),g.classList.add(c),indexes=d[e][c],f.appendChild(g),indexes)for(h=indexes[0];h<=indexes[1];++h)i=b.createElement(a),i.classList.add(c+h),g.appendChild(i)})}),this.cubeObj=cubeObj,this.wrapper.appendChild(c),e=function(){w(this.cubeObj.cube,this.afterTransitionLayout),this.resetCube(),this.playNext()}.bind(this),cubeObj.top.addEventListener(f,e),cubeObj.middle.addEventListener(f,e)},j.generateTimeline=function(){var a,b;b=n(this.layout),a=this.moves.map(function(a){var c,d;switch(c={code:a.code,highlight:a.highlight,cssRotates:p(a.code)},b=q(b,a.code,!1),c.beforeAnimation=n(b),d=m(a.code)?s:r,a.code.charAt(1)){case"'":case"i":b=d(b,!0);break;case"2":b=d(d(b));break;default:b=d(b,!1)}return c.afterAnimation=n(b),b=q(b,a.code,!0),c}),this.timeline=a};var o=function(a){switch(a){case"R":return"#C41E3A";case"G":return"#009E60";case"B":return"#0051BA";case"O":return"#FF5800";case"Y":return"#FFD500";case"W":return"#FFF"}return"gray"},p=function(a){switch(a.charAt(0)){case"F":case"S":return"";case"U":return"rotateX(90deg)";case"D":case"E":return"rotateX(-90deg)";case"B":return"rotateX(180deg)";case"L":case"M":return"rotateY(-90deg)";case"R":return"rotateY(90deg)"}},q=function(a,b,c){var d=n(a);switch(b.charAt(0)+(c?"i":"")){case"F":case"Fi":case"S":case"Si":return{f:d.f,u:d.u,r:d.r,b:t(t(d.b)),l:d.l,d:d.d};case"U":return{f:t(t(d.u)),u:d.b,r:t(d.r,!0),b:d.d,l:t(d.l,!1),d:d.f};case"Ui":return{f:d.d,u:t(t(d.f)),r:t(d.r,!1),b:d.u,l:t(d.l,!0),d:d.b};case"B":return{f:t(t(d.b)),u:t(t(d.d)),r:t(t(d.r)),b:d.f,l:t(t(d.l)),d:t(t(d.u))};case"Bi":return{f:d.b,u:t(t(d.d)),r:t(t(d.r)),b:t(t(d.f)),l:t(t(d.l)),d:t(t(d.u))};case"D":case"E":return{f:d.d,u:t(t(d.f)),r:t(d.r,!1),b:t(t(d.u)),l:t(d.l,!0),d:t(t(d.b))};case"Di":case"Ei":return{f:t(t(d.u)),u:t(t(d.b)),r:t(d.r,!0),b:t(t(d.d)),l:t(d.l,!1),d:d.f};case"L":case"M":return{f:t(d.l,!1),u:t(d.u,!0),r:t(d.f,!1),b:t(d.r,!1),l:t(d.b,!0),d:t(d.d,!1)};case"Li":case"Mi":return{f:t(d.r,!0),u:t(d.u,!1),r:t(d.b,!0),b:t(d.l,!1),l:t(d.f,!0),d:t(d.d,!0)};case"R":return{f:t(d.r,!0),u:t(d.u,!1),r:t(d.b,!1),b:t(d.l,!0),l:t(d.f,!0),d:t(d.d,!0)};case"Ri":return{f:t(d.l,!1),u:t(d.u,!0),r:t(d.f,!1),b:t(d.r,!0),l:t(d.b,!1),d:t(d.d,!1)}}},r=function(a,b){var c=n(a);return{f:t(c.f,b),u:u(c.u,c.l,c.r,b),r:u(c.r,c.u,c.d,b),d:u(c.d,c.r,c.l,b),l:u(c.l,c.d,c.u,b),b:c.b}},s=function(a,b){var c=n(a);return{f:c.f,u:v(c.u,c.l,c.r,b),r:v(c.r,c.u,c.d,b),d:v(c.d,c.r,c.l,b),l:v(c.l,c.d,c.u,b),b:c.b}},t=function(a,b){var c=n(a);return b?t(t(t(c))):[c[6],c[3],c[0],c[7],c[4],c[1],c[8],c[5],c[2]]},u=function(a,b,c,d){var e,f;return e=n(a),f=n(d?c:b),[f[0],f[1],f[2],e[3],e[4],e[5],e[6],e[7],e[8]]},v=function(a,b,c,d){var e,f;return e=n(a),f=n(d?c:b),[e[0],e[1],e[2],f[3],f[4],f[5],e[6],e[7],e[8]]},w=function(a,b){c.forEach(function(c){b[c].forEach(function(b,d){a.querySelector("."+c+d).style.background=o(b)})})},x=function(a,b){[].forEach.call(a.querySelectorAll(".highlight"),function(a){a.classList.remove("highlight")}),b&&[].forEach.call(a.querySelectorAll("."+b.split(",").join(",.")),function(a){a.classList.add("highlight")})};j.generateNavigation=function(){var a,c,d,e,f;a="button",f=b.createElement("nav"),c=b.createElement(a),c.classList.add("previous"),c.innerHTML="Previous",f.appendChild(c),c.addEventListener("click",this.playPrevious.bind(this)),d=b.createElement(a),d.classList.add("play"),d.innerHTML="Play",f.appendChild(d),d.addEventListener("click",this.playPause.bind(this)),e=b.createElement(a),e.classList.add("next"),e.innerHTML="Next",f.appendChild(e),e.addEventListener("click",this.playNext.bind(this)),this.wrapper.insertBefore(f,this.nodes.moves),this.nodes.navigation=f},j.resetCube=function(){this.cubeObj.top.classList.remove("rotate-anticlockwise","rotate-clockwise","rotate-twice"),this.cubeObj.middle.classList.remove("rotate-anticlockwise","rotate-clockwise","rotate-twice")},j.playMove=function(a){var b;a.preventDefault(),b=parseInt("0"+a.target.getAttribute("data-index"),10),this.current=b-1,this.playNext()},j.playPause=function(){this.playing=!this.playing,this.current=Math.max(this.current-1,-1),this.playNext()},j.playPrevious=function(){this.current=Math.max(this.current-2,-1),this.playNext()},j.playNext=function(){var a,b,c,d,f,h,i;if(this.resetCube(),c=this.cubeObj.cube,d=this.cubeObj.top,middle=this.cubeObj.middle,f=++this.current,f>=this.timeline.length)return void--this.current;if(a=this.timeline[f],w(c,a.beforeAnimation),x(c,a.highlight),this.afterTransitionLayout=a.afterAnimation,h=m(a.code)?middle:d,c.style[g]=e+a.cssRotates,this.playing){switch(a.code.charAt(1)){case"'":case"i":i="rotate-anticlockwise";break;case"2":i="rotate-twice";break;default:i="rotate-clockwise"}setTimeout(function(){h.classList.add(i)},1e3)}b=this.nodes.moves.querySelector("li.is-playing"),b&&b.classList.remove("is-playing"),this.nodes.moves.querySelector("li:nth-child("+(f+1)+")").classList.add("is-playing")},h()}(window,document);