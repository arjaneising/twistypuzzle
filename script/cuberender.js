/*! cuberender 2015-08-18 */
!function(a,b){var c,d,e;c=["f","u","r","l","d","b"],middleMoves=["M","E","S"],e="rotate3D(-1, -1, 0, 45deg) ",d={top:{f:[0,8],u:[0,2],r:[0,2],d:[0,2],l:[0,2],b:!1},middle:{f:!1,u:[3,5],r:[3,5],d:[3,5],l:[3,5],b:!1},bottom:{f:!1,u:[6,8],r:[6,8],d:[6,8],l:[6,8],b:[0,8]}};var f=function(){var a=b.querySelectorAll(".cuberender");[].forEach.call(a,function(a){var b=Object.create(g,h);b.create(a)})},g=Object.create(null),h={wrapper:{writable:!0},layout:{writable:!0},moves:{writable:!0},cubeObj:{writable:!0},nodes:{writable:!0},current:{writable:!0},afterTransitionLayout:{writable:!0},playing:{writable:!0}},i=function(a){return-1!==middleMoves.indexOf(a.charAt(0))},j=function(a){if(null===a||"object"!=typeof a||"isActiveClone"in a)return a;var b=a.constructor();for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(a.isActiveClone=null,b[c]=j(a[c]),delete a.isActiveClone);return b};g.create=function(a){this.wrapper=a,this.nodes={},this.current=-1,this.playing=!1,this.readLayout(),this.readMoves(),this.generateCube(),this.generateTimeline(),this.generateNavigation(),this.generateTimelineNavigation(),this.playNext()},g.generateTimelineNavigation=function(){this.nodes.moves.addEventListener("click",this.playMove.bind(this)),[].forEach.call(this.nodes.moves.querySelectorAll("li"),function(a,c){var d=b.createElement("a");d.href="#",d.innerHTML=a.innerHTML,a.innerHTML="",a.appendChild(d),d.setAttribute("data-index",c)})},g.readLayout=function(){var a,b;return b=this.wrapper.querySelector(".cube-layout"),null===b?!1:(a={},c.forEach(function(c){var d,e;return d=b.querySelector("."+c),null===d?void(a[c]=[]):(e=d.innerText.split(" "),void(9===e.length?a[c]=e:a[c]=[]))}),void(this.layout=a))},g.readMoves=function(){var a;return this.nodes.moves=this.wrapper.querySelector(".moves"),null===this.nodes.moves?!1:(a=[].map.call(this.nodes.moves.querySelectorAll("li"),function(a){return{code:a.innerText,highlight:a.getAttribute("data-highlight")||null}}),void(this.moves=a))},g.generateCube=function(){var a,c;a="div",c=b.createElement(a),c.classList.add("cube"),cubeObj={cube:c},Object.keys(d).forEach(function(e){var f=b.createElement(a);f.classList.add(e,"layer"),cubeObj[e]=f,c.appendChild(f),Object.keys(d[e]).forEach(function(c){var g,h,i;if(g=b.createElement(a),g.classList.add(c),indexes=d[e][c],f.appendChild(g),indexes)for(h=indexes[0];h<=indexes[1];++h)i=b.createElement(a),i.classList.add(c+h),g.appendChild(i)})}),this.cubeObj=cubeObj,this.wrapper.appendChild(c),afterTransition=function(){s(this.cubeObj.cube,this.afterTransitionLayout),this.resetCube(),this.playNext()}.bind(this),cubeObj.top.addEventListener("webkitTransitionEnd",afterTransition),cubeObj.middle.addEventListener("webkitTransitionEnd",afterTransition)},g.generateTimeline=function(){var a,b;b=j(this.layout),a=this.moves.map(function(a){var c,d;switch(c={code:a.code,highlight:a.highlight,cssRotates:l(a.code)},b=m(b,a.code,!1),c.beforeAnimation=j(b),d=i(a.code)?o:n,a.code.charAt(1)){case"'":case"i":b=d(b,!0);break;case"2":b=d(d(b));break;default:b=d(b,!1)}return c.afterAnimation=j(b),b=m(b,a.code,!0),c}),this.timeline=a};var k=function(a){switch(a){case"R":return"#C41E3A";case"G":return"#009E60";case"B":return"#0051BA";case"O":return"#FF5800";case"Y":return"#FFD500";case"W":return"#FFF"}return"gray"},l=function(a){switch(a.charAt(0)){case"F":case"S":return"";case"U":return"rotateX(90deg)";case"D":case"E":return"rotateX(-90deg)";case"B":return"rotateX(180deg)";case"L":case"M":return"rotateY(-90deg)";case"R":return"rotateY(90deg)"}},m=function(a,b,c){var d=j(a);switch(b.charAt(0)+(c?"i":"")){case"F":case"Fi":case"S":case"Si":return{f:d.f,u:d.u,r:d.r,b:p(p(d.b)),l:d.l,d:d.d};case"U":return{f:p(p(d.u)),u:d.b,r:p(d.r,!0),b:d.d,l:p(d.l,!1),d:d.f};case"Ui":return{f:d.d,u:p(p(d.f)),r:p(d.r,!1),b:d.u,l:p(d.l,!0),d:d.b};case"B":return{f:p(p(d.b)),u:p(p(d.d)),r:p(p(d.r)),b:d.f,l:p(p(d.l)),d:p(p(d.u))};case"Bi":return{f:d.b,u:p(p(d.d)),r:p(p(d.r)),b:p(p(d.f)),l:p(p(d.l)),d:p(p(d.u))};case"D":case"E":return{f:d.d,u:p(p(d.f)),r:p(d.r,!1),b:p(p(d.u)),l:p(d.l,!0),d:p(p(d.b))};case"Di":case"Ei":return{f:p(p(d.u)),u:p(p(d.b)),r:p(d.r,!0),b:p(p(d.d)),l:p(d.l,!1),d:d.f};case"L":case"M":return{f:p(d.l,!1),u:p(d.u,!0),r:p(d.f,!1),b:p(d.r,!1),l:p(d.b,!0),d:p(d.d,!1)};case"Li":case"Mi":return{f:p(d.r,!0),u:p(d.u,!1),r:p(d.b,!0),b:p(d.l,!1),l:p(d.f,!0),d:p(d.d,!0)};case"R":return{f:p(d.r,!0),u:p(d.u,!1),r:p(d.b,!1),b:p(d.l,!0),l:p(d.f,!0),d:p(d.d,!0)};case"Ri":return{f:p(d.l,!1),u:p(d.u,!0),r:p(d.f,!1),b:p(d.r,!0),l:p(d.b,!1),d:p(d.d,!1)}}},n=function(a,b){var c=j(a);return{f:p(c.f,b),u:q(c.u,c.l,c.r,b),r:q(c.r,c.u,c.d,b),d:q(c.d,c.r,c.l,b),l:q(c.l,c.d,c.u,b),b:c.b}},o=function(a,b){var c=j(a);return{f:c.f,u:r(c.u,c.l,c.r,b),r:r(c.r,c.u,c.d,b),d:r(c.d,c.r,c.l,b),l:r(c.l,c.d,c.u,b),b:c.b}},p=function(a,b){var c=j(a);return b?p(p(p(c))):[c[6],c[3],c[0],c[7],c[4],c[1],c[8],c[5],c[2]]},q=function(a,b,c,d){var e,f;return e=j(a),f=j(d?c:b),[f[0],f[1],f[2],e[3],e[4],e[5],e[6],e[7],e[8]]},r=function(a,b,c,d){var e,f;return e=j(a),f=j(d?c:b),[e[0],e[1],e[2],f[3],f[4],f[5],e[6],e[7],e[8]]},s=function(a,b){c.forEach(function(c){b[c].forEach(function(b,d){a.querySelector("."+c+d).style.background=k(b)})})},t=function(a,b){[].forEach.call(a.querySelectorAll(".highlight"),function(a){a.classList.remove("highlight")}),b&&[].forEach.call(a.querySelectorAll("."+b.split(",").join(",.")),function(a){a.classList.add("highlight")})};g.generateNavigation=function(){var a,c,d,e,f;a="button",f=b.createElement("nav"),c=b.createElement(a),c.classList.add("previous"),c.innerHTML="Previous",f.appendChild(c),d=b.createElement(a),d.classList.add("play"),d.innerHTML="Play",f.appendChild(d),e=b.createElement(a),e.classList.add("next"),e.innerHTML="Next",f.appendChild(e),c.addEventListener("click",this.playPrevious.bind(this)),d.addEventListener("click",this.playPause.bind(this)),e.addEventListener("click",this.playNext.bind(this)),this.wrapper.insertBefore(f,this.nodes.moves),this.nodes.navigation=f},g.resetCube=function(){this.cubeObj.top.classList.remove("rotate-anticlockwise","rotate-clockwise","rotate-twice"),this.cubeObj.middle.classList.remove("rotate-anticlockwise","rotate-clockwise","rotate-twice")},g.playMove=function(a){var b;a.preventDefault(),b=parseInt("0"+a.target.getAttribute("data-index"),10),this.current=b-1,this.playNext()},g.playPause=function(){this.playing=!this.playing,this.current=Math.max(this.current-1,-1),this.playNext()},g.playPrevious=function(){this.current=Math.max(this.current-2,-1),this.playNext()},g.playNext=function(){var a,b,c,d,f,g;return this.resetCube(),c=this.cubeObj.cube,d=this.cubeObj.top,middle=this.cubeObj.middle,f=++this.current,f>=this.timeline.length?void--this.current:(a=this.timeline[f],s(c,a.beforeAnimation),t(c,a.highlight),this.afterTransitionLayout=a.afterAnimation,g=i(a.code)?middle:d,c.style.transform=e+a.cssRotates,this.playing&&setTimeout(function(){var b;switch(a.code.charAt(1)){case"'":case"i":b="rotate-anticlockwise";break;case"2":b="rotate-twice";break;default:b="rotate-clockwise"}g.classList.add(b)},1e3),b=this.nodes.moves.querySelector("li.is-playing"),b&&b.classList.remove("is-playing"),void this.nodes.moves.querySelector("li:nth-child("+(f+1)+")").classList.add("is-playing"))},f()}(window,document);